<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{.Title}}</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container">
            <a class="navbar-brand" href="/admin/">
                <i class="fas fa-server"></i> Claude 代理管理后台
            </a>
            <div class="navbar-nav ms-auto">
                <a class="nav-link" href="/admin/">控制台</a>
                <a class="nav-link" href="/admin/endpoints">端点配置</a>
                <a class="nav-link" href="/admin/taggers">Taggers</a>
                <a class="nav-link" href="/admin/logs">请求日志</a>
                <a class="nav-link active" href="/admin/settings">系统设置</a>
            </div>
        </div>
    </nav>

    <div class="container mt-4">
        <div class="row">
            <div class="col-12">
                <div class="card">
                    <div class="card-header">
                        <h5 class="mb-0">服务器配置</h5>
                        <small class="text-muted">当前配置（只读）</small>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6">
                                <h6>服务器设置</h6>
                                <table class="table table-sm">
                                    <tr>
                                        <th>代理端口:</th>
                                        <td><code>{{.Config.Server.Port}}</code></td>
                                    </tr>
                                    <tr>
                                        <th>认证令牌:</th>
                                        <td><code>{{.Config.Server.AuthToken}}</code></td>
                                    </tr>
                                </table>
                            </div>
                            <div class="col-md-6">
                                <h6>网页管理设置</h6>
                                <table class="table table-sm">
                                    <tr>
                                        <th>启用:</th>
                                        <td>
                                            {{if .Config.WebAdmin.Enabled}}
                                                <span class="badge bg-success">是</span>
                                            {{else}}
                                                <span class="badge bg-secondary">否</span>
                                            {{end}}
                                        </td>
                                    </tr>
                                    <tr>
                                        <th>主机:</th>
                                        <td><code>{{.Config.WebAdmin.Host}}</code></td>
                                    </tr>
                                    <tr>
                                        <th>端口:</th>
                                        <td><code>{{.Config.WebAdmin.Port}}</code></td>
                                    </tr>
                                </table>
                            </div>
                        </div>

                        <div class="row mt-4">
                            <div class="col-md-6">
                                <h6>日志配置</h6>
                                <table class="table table-sm">
                                    <tr>
                                        <th>日志级别:</th>
                                        <td><code>{{.Config.Logging.Level}}</code></td>
                                    </tr>
                                    <tr>
                                        <th>记录请求类型:</th>
                                        <td>
                                            <span class="badge {{if eq .Config.Logging.LogRequestTypes "all"}}bg-info{{else if eq .Config.Logging.LogRequestTypes "failed"}}bg-warning{{else}}bg-success{{end}}">
                                                {{.Config.Logging.LogRequestTypes}}
                                            </span>
                                        </td>
                                    </tr>
                                    <tr>
                                        <th>记录请求体:</th>
                                        <td>
                                            <span class="badge {{if eq .Config.Logging.LogRequestBody "full"}}bg-success{{else if eq .Config.Logging.LogRequestBody "truncated"}}bg-warning{{else}}bg-secondary{{end}}">
                                                {{.Config.Logging.LogRequestBody}}
                                            </span>
                                        </td>
                                    </tr>
                                    <tr>
                                        <th>记录响应体:</th>
                                        <td>
                                            <span class="badge {{if eq .Config.Logging.LogResponseBody "full"}}bg-success{{else if eq .Config.Logging.LogResponseBody "truncated"}}bg-warning{{else}}bg-secondary{{end}}">
                                                {{.Config.Logging.LogResponseBody}}
                                            </span>
                                        </td>
                                    </tr>
                                    <tr>
                                        <th>日志目录:</th>
                                        <td><code>{{.Config.Logging.LogDirectory}}</code></td>
                                    </tr>
                                </table>
                            </div>
                            <div class="col-md-6">
                                <h6>校验配置</h6>
                                <table class="table table-sm">
                                    <tr>
                                        <th>严格 Anthropic 格式:</th>
                                        <td>
                                            {{if .Config.Validation.StrictAnthropicFormat}}
                                                <span class="badge bg-success">已启用</span>
                                            {{else}}
                                                <span class="badge bg-secondary">已禁用</span>
                                            {{end}}
                                        </td>
                                    </tr>
                                    <tr>
                                        <th>校验流式响应:</th>
                                        <td>
                                            {{if .Config.Validation.ValidateStreaming}}
                                                <span class="badge bg-success">已启用</span>
                                            {{else}}
                                                <span class="badge bg-secondary">已禁用</span>
                                            {{end}}
                                        </td>
                                    </tr>
                                    <tr>
                                        <th>无效时断开连接:</th>
                                        <td>
                                            {{if .Config.Validation.DisconnectOnInvalid}}
                                                <span class="badge bg-warning">是</span>
                                            {{else}}
                                                <span class="badge bg-secondary">否</span>
                                            {{end}}
                                        </td>
                                    </tr>
                                </table>
                            </div>
                        </div>

                        <div class="row mt-4">
                            <div class="col-12">
                                <h6>运行状态</h6>
                                <div class="row">
                                    <div class="col-md-3">
                                        <div class="card bg-light">
                                            <div class="card-body text-center">
                                                <h5 class="text-primary">{{len .Config.Endpoints}}</h5>
                                                <small class="text-muted">端点总数</small>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="card bg-light">
                                            <div class="card-body text-center">
                                                <h5 class="text-success">{{.EnabledCount}}</h5>
                                                <small class="text-muted">已启用端点</small>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="card bg-light">
                                            <div class="card-body text-center">
                                                <h5 class="text-info text-uppercase">{{.Config.Logging.Level}}</h5>
                                                <small class="text-muted">日志级别</small>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="card bg-light">
                                            <div class="card-body text-center">
                                                <h5 class="{{if .Config.Validation.StrictAnthropicFormat}}text-success{{else}}text-secondary{{end}}">
                                                    {{if .Config.Validation.StrictAnthropicFormat}}<i class="fas fa-shield-alt"></i>{{else}}<i class="fas fa-shield"></i>{{end}}
                                                </h5>
                                                <small class="text-muted">校验</small>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row mt-4">
                            <div class="col-12">
                                <h6>端点概览</h6>
                                <table class="table table-sm">
                                    <thead>
                                        <tr>
                                            <th>优先级</th>
                                            <th>名称</th>
                                            <th>URL</th>
                                            <th>类型</th>
                                            <th>路径前缀</th>
                                            <th>认证类型</th>
                                            <th>启用</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        {{range .Config.Endpoints}}
                                        <tr>
                                            <td><span class="badge bg-info">{{.Priority}}</span></td>
                                            <td><strong>{{.Name}}</strong></td>
                                            <td><code>{{.URL}}</code></td>
                                            <td>
                                                <span class="badge {{if eq .EndpointType "openai"}}bg-warning{{else}}bg-primary{{end}}">
                                                    {{if .EndpointType}}{{.EndpointType}}{{else}}anthropic{{end}}
                                                </span>
                                            </td>
                                            <td>
                                                {{if eq .EndpointType "openai"}}
                                                    <code>{{.PathPrefix}}</code>
                                                {{else}}
                                                    <span class="text-muted">/v1/messages</span>
                                                {{end}}
                                            </td>
                                            <td>
                                                <span class="badge {{if eq .AuthType "api_key"}}bg-primary{{else}}bg-secondary{{end}}">
                                                    {{.AuthType}}
                                                </span>
                                            </td>
                                            <td>
                                                {{if .Enabled}}
                                                    <span class="badge bg-success"><i class="fas fa-check"></i> 是</span>
                                                {{else}}
                                                    <span class="badge bg-secondary"><i class="fas fa-times"></i> 否</span>
                                                {{end}}
                                            </td>
                                        </tr>
                                        {{end}}
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <div class="mt-4">
                            <div class="alert alert-info">
                                <h6><i class="fas fa-info-circle"></i> 配置信息:</h6>
                                <ul class="mb-0">
                                    <li><strong>服务器:</strong> 代理服务器监听端口 {{.Config.Server.Port}}</li>
                                    <li><strong>网页管理:</strong> 管理界面在 {{.Config.WebAdmin.Host}}:{{.Config.WebAdmin.Port}}</li>
                                    <li><strong>端点:</strong> 可通过 <a href="/admin/endpoints">端点配置</a> 页面管理已配置的端点</li>
                                    <li><strong>日志:</strong> 请求日志存储在 <code>{{.Config.Logging.LogDirectory}}</code> 目录中</li>
                                </ul>
                            </div>
                            <div class="alert alert-warning">
                                <h6><i class="fas fa-exclamation-triangle"></i> 配置说明:</h6>
                                <ul class="mb-0">
                                    <li>服务器和日志配置更改需要编辑 <code>config.yaml</code> 文件并重启服务器</li>
                                    <li>端点配置可通过网页界面管理并自动保存</li>
                                    <li>此界面仅供查看，出于安全考虑 - 在此处做的配置更改不会持久化</li>
                                    <li>在手动修改 <code>config.yaml</code> 之前请始终备份您的配置</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>